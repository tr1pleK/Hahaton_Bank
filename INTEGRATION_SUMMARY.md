# ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

## üéâ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è
- ‚úÖ –ö–æ–¥ –∏–∑ `cybergarden_ML.py` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –º–µ—Ç–æ–¥ `train()` –∫–ª–∞—Å—Å–∞ `TransactionClassifier`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LightGBM —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`_extract_features`)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã fallback –ø—Ä–∞–≤–∏–ª–∞ (`_apply_fallback_rules`)

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- ‚úÖ –ö–æ–¥ –∏–∑ `test_classifier.py` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –º–µ—Ç–æ–¥—ã `predict()` –∏ `predict_from_dataframe()`
- ‚úÖ Fallback –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ `TransactionCategory`

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `lightgbm==4.1.0` –≤ `requirements.txt`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `joblib==1.3.2` –≤ `requirements.txt`

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ `categorizer.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å
- ‚úÖ –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –≥–æ—Ç–æ–≤ (`scripts/train_model.py`)
- ‚úÖ Docker –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `ml_models`

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```

### –®–∞–≥ 2: –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å
```bash
python scripts/train_model.py "–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/—Ñ–∞–π–ª—É/ci_data.csv"
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É
```bash
uvicorn app.main:app --reload
```

## üóëÔ∏è –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å:
- `app/ml/cybergarden_ML.py` (–∫–æ–¥ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `transaction_classifier.py`)
- `app/ml/test_classifier.py` (–∫–æ–¥ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `transaction_classifier.py`)

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ**: –£–¥–∞–ª—è–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ ml/
‚îÇ       ‚îú‚îÄ‚îÄ transaction_classifier.py  # ‚úÖ –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å (LightGBM)
‚îÇ       ‚îú‚îÄ‚îÄ categorizer.py             # ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ cybergarden_ML.py         # ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
‚îÇ       ‚îî‚îÄ‚îÄ test_classifier.py        # ‚ö†Ô∏è –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ train_model.py                # ‚úÖ –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ ml_models/
‚îÇ   ‚îî‚îÄ‚îÄ transaction_classifier.pkl    # üì¶ –°–æ–∑–¥–∞—Å—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ requirements.txt                   # ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏:
```python
from app.ml.transaction_classifier import TransactionClassifier

classifier = TransactionClassifier()
print(f"–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞: {classifier.is_trained}")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:
```python
from app.ml.categorizer import categorize_transaction
from datetime import datetime

category = categorize_transaction(
    description="Test",
    amount=100.0,
    is_expense=True,
    date=datetime.now()
)
print(f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {category}")
```

## üìä –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

1. **LightGBM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
   - n_estimators=100
   - num_leaves=15
   - learning_rate=0.05
   - class_weight="balanced"

2. **Fallback –ø—Ä–∞–≤–∏–ª–∞** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏:
   - Salary: Deposit == 34800 –∏ –¥–∞—Ç–∞ 24‚Äì26
   - Rent: Withdrawal 3900‚Äì7500 –∏ –¥–∞—Ç–∞ ‚â§6
   - Shopping: 150‚Äì3000 –≤ –ø–µ—Ä–≤—ã–µ 5 –¥–Ω–µ–π –ø–æ—Å–ª–µ –∑–∞—Ä–ø–ª–∞—Ç—ã

3. **–ü—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–¥–µ–ª–∏**:
   - is_withdrawal, is_deposit, amount, net_flow, balance_before
   - day_of_month, day_of_week, is_month_start, is_month_end
   - is_salary_like, is_rent_like, days_since_last_salary, days_since_last_txn
   - Withdrawal, Deposit

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–í—Å–µ —Ñ–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã. –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –∏ –Ω–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!

